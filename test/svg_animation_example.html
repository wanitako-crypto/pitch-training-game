<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG & JavaScript Animation Example</title>
    <style>
        /* --- 全体レイアウト --- */
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #2c3e50;
            color: #ecf0f1;
            font-family: 'Poppins', sans-serif;
            text-align: center;
            flex-direction: column;
            margin: 0;
        }
        .info {
            margin-bottom: 2rem;
        }

        /* --- グーイーエフェクトのコンテナ --- */
        .button-container {
            /* ここでSVGフィルターを適用するのが最も重要なポイント */
            filter: url(#gooey);
            position: relative;
            width: 250px;
            height: 250px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- メインボタンとパーティクル（粒子）のスタイル --- */
        .main-button {
            position: absolute;
            z-index: 2; /* パーティクルより手前に表示 */
            width: 120px;
            height: 120px;
            background-color: #3498db;
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: bold;
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        .particle {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #3498db;
            border-radius: 50%;
            /* アニメーションを滑らかにする `cubic-bezier`でバウンドするような動きを指定 */
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* --- ホバー時のアニメーション --- */
        /* コンテナにホバーした時に、中のパーティクルを動かす */
        /* SVGフィルターの効果により、動いたパーティクルがメインボタンと融合・分離するように見える */
        .button-container:hover .particle:nth-of-type(1) { transform: translate(-80px, 0); }
        .button-container:hover .particle:nth-of-type(2) { transform: translate(80px, 0); }
        .button-container:hover .particle:nth-of-type(3) { transform: translate(0, -80px); }
        .button-container:hover .particle:nth-of-type(4) { transform: translate(0, 80px); }
        .button-container:hover .particle:nth-of-type(5) { transform: translate(-60px, -60px); }
        .button-container:hover .particle:nth-of-type(6) { transform: translate(60px, -60px); }
        .button-container:hover .particle:nth-of-type(7) { transform: translate(-60px, 60px); }
        .button-container:hover .particle:nth-of-type(8) { transform: translate(60px, 60px); }
        
        /* --- JavaScriptによるクリック時のフィードバック --- */
        .main-button.clicked {
             /* `pop`というキーフレームアニメーションを実行 */
             animation: pop 0.3s ease-in-out;
        }
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); } /* 少し大きくなる */
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="info">
        <h1>SVGフィルターを使った表現</h1>
        <p>ボタンにカーソルを合わせると、液体のようなエフェクト（Gooey Effect）が見られます。<br>クリックするとJavaScriptによるアニメーションが発動します。</p>
    </div>

    <!-- フィルターを適用するコンテナ -->
    <div class="button-container">
        <!-- これらのパーティクルがメインボタンと融合する -->
        <span class="particle"></span>
        <span class="particle"></span>
        <span class="particle"></span>
        <span class="particle"></span>
        <span class="particle"></span>
        <span class="particle"></span>
        <span class="particle"></span>
        <span class="particle"></span>
        <div class="main-button">HOVER</div>
    </div>

    <!-- 
      SVGフィルターの定義エリア
      - `position:absolute; width:0; height:0;` で画面上には表示されないようにする
      - `<defs>`内に定義したフィルターは、CSSの `filter: url(#id名)` で呼び出せる
    -->
    <svg style="position:absolute; width:0; height:0;" xmlns="http://www.w3.org/2000/svg" version="1.1">
        <defs>
            <filter id="gooey">
                <!-- 1. feGaussianBlur: 要素をぼかす -->
                <!-- `stdDeviation`の値が大きいほど、ぼかしが強くなる -->
                <feGaussianBlur in="SourceGraphic" stdDeviation="12" result="blur" />
                
                <!-- 2. feColorMatrix: 色の変換を行う。ここではアルファチャンネル（透明度）を操作して、ぼかしの境界をくっきりさせる -->
                <!-- `values`の最後の行 `0 0 0 20 -9` が重要。これにより、ぼやけて薄くなった部分の透明度を急激に上げて不透明に近づけ、境界をシャープにする -->
                <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 20 -9" result="goo" />
                
                <!-- 3. feBlend: 元のグラフィック（`SourceGraphic`）と、加工したグラフィック（`goo`）をブレンド（重ね合わせる） -->
                <!-- これにより、シャープになった境界の内側が元の色で塗りつぶされる -->
                <feBlend in="SourceGraphic" in2="goo" />
            </filter>
        </defs>
    </svg>

    <script>
        const button = document.querySelector('.main-button');
        
        button.addEventListener('click', (e) => {
            e.preventDefault(); // aタグのデフォルトのページ遷移を防ぐ
            
            // 1. JavaScriptで 'clicked' クラスを追加し、CSSで定義した `pop` アニメーションを発動させる
            button.classList.add('clicked');
            
            // 2. ボタンのテキストを変更する
            if (button.textContent !== 'CLICKED!') {
                button.textContent = 'CLICKED!';
            } else {
                button.textContent = 'AGAIN!';
            }

            // 3. アニメーション終了後に 'clicked' クラスを削除し、再度アニメーションできるようにする
            setTimeout(() => {
                button.classList.remove('clicked');
            }, 300); // CSSの `animation-duration` と合わせる
        });

        // マウスがコンテナから離れたらテキストを元に戻す
        const buttonContainer = document.querySelector('.button-container');
        buttonContainer.addEventListener('mouseleave', () => {
             setTimeout(() => {
                button.textContent = "HOVER";
            }, 300);
        });
    </script>
</body>
</html>

