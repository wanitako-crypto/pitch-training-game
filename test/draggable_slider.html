<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slider Showcase</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

        /* --- 全体レイアウト --- */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #eef1f5;
            color: #333;
            padding: 2rem;
        }

        h1, h2 { text-align: center; color: #2c3e50; }
        h1 { margin-bottom: 3rem; }
        .divider {
            border: 0;
            height: 1px;
            background: #d1d9e6;
            margin: 5rem auto;
            width: 100%;
        }
        .showcase-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 4rem;
            max-width: 600px;
            margin: 0 auto;
        }
        .showcase-item { text-align: center; }
        .showcase-item h3 { margin-bottom: 2rem; font-size: 1.5rem; }

        /* --- 共通スライダースタイル --- */
        .slider-container {
            position: relative;
            display: flex;
            align-items: center;
            user-select: none; /* テキスト選択を無効化 */
            -webkit-user-select: none;
        }
        .slider-track, .slider-fill { position: absolute; border-radius: 99px; /* 角を完全に丸くする */ }
        .slider-thumb {
            position: absolute;
            cursor: grab; /* カーソルを「掴む」アイコンに */
            transition: transform 0.2s, box-shadow 0.2s; /* アニメーションを滑らかに */
        }
        /* :activeはクリック中、.is-activeはJSで付与するクラス（ドラッグ中） */
        .slider-thumb:active, .slider-thumb.is-active { cursor: grabbing; /* 「掴んでいる」アイコンに */ }
        .slider-value { margin-top: 1rem; font-size: 1.2rem; font-weight: 600; }

        /* --- デフォルトスタイル --- */
        .slider-default .slider-track { background-color: #d1d9e6; }
        .slider-default .slider-fill { background-color: #3498db; }
        .slider-default .slider-thumb {
            width: 24px; height: 24px;
            background-color: #fff;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        .slider-default .slider-value { color: #2c3e50; }

        /* --- 水平スライダー特有のスタイル --- */
        .horizontal-slider { height: 50px; width: 100%; }
        .horizontal-slider .slider-track, .horizontal-slider .slider-fill { width: 100%; height: 8px; }
        .horizontal-slider .slider-thumb { top: 50%; transform: translateY(-50%); /* Y軸方向に中央揃え */ }

        /* --- リッチ（ネオン）スタイル --- */
        .rich-style-wrapper {
            background-color: #1a1a2e; /* 背景をダークに */
            padding: 3rem 1rem;
            border-radius: 20px;
        }
        .rich-style-wrapper h2, .rich-style-wrapper h3 { color: #fff; }

        .slider-rich .slider-track { background-color: rgba(0,0,0,0.3); }
        .slider-rich .slider-fill {
            background: linear-gradient(90deg, #00f2fe, #4facfe); /* グラデーション */
            box-shadow: 0 0 8px #4facfe, 0 0 12px #00f2fe; /* グロー（光彩）効果 */
        }
        .slider-rich .slider-thumb {
            width: 26px; height: 26px;
            background-color: #fff;
            border-radius: 50%;
            box-shadow: 0 0 8px rgba(255,255,255,0.8), 0 0 16px #4facfe; /* 白と青のグロー */
        }
        /* ドラッグ中のハンドルのスタイル */
        .slider-rich .slider-thumb:active, .slider-rich .slider-thumb.is-active {
             box-shadow: 0 0 10px rgba(255,255,255,1), 0 0 25px #00f2fe; /* グローを強くする */
             transform: translateY(-50%) scale(1.15); /* 少し大きくする */
        }
        .slider-rich .slider-value { color: #fff; }

    </style>
</head>
<body>

    <h1>スライダー・ショーケース</h1>

    <div class="showcase-grid">
        <div class="showcase-item">
            <h3>ベーシックスライダー</h3>
            <div class="slider-container horizontal-slider slider-default" id="slider-basic">
                <div class="slider-track"></div><div class="slider-fill"></div><div class="slider-thumb"></div>
            </div>
            <div class="slider-value" id="slider-basic-value">0%</div>
        </div>
        <div class="showcase-item">
            <h3>レンジスライダー</h3>
            <div class="slider-container horizontal-slider slider-default" id="slider-range">
                <div class="slider-track"></div><div class="slider-fill"></div>
                <!-- レンジスライダーは2つのハンドルを持つ -->
                <div class="slider-thumb" id="thumb-min"></div><div class="slider-thumb" id="thumb-max"></div>
            </div>
            <div class="slider-value" id="slider-range-value">0% - 100%</div>
        </div>
    </div>

    <hr class="divider">
    
    <div class="rich-style-wrapper">
        <h2>リッチなスタイル</h2>
        <div class="showcase-grid">
            <div class="showcase-item">
                <h3>ネオングロー・スライダー</h3>
                <div class="slider-container horizontal-slider slider-rich" id="slider-rich-basic">
                    <div class="slider-track"></div><div class="slider-fill"></div><div class="slider-thumb"></div>
                </div>
                <div class="slider-value" id="slider-rich-basic-value">0%</div>
            </div>
            <div class="showcase-item">
                <h3>ネオングロー・レンジスライダー</h3>
                <div class="slider-container horizontal-slider slider-rich" id="slider-rich-range">
                    <div class="slider-track"></div><div class="slider-fill"></div>
                    <div class="slider-thumb" id="thumb-rich-min"></div><div class="slider-thumb" id="thumb-rich-max"></div>
                </div>
                <div class="slider-value" id="slider-rich-range-value">0% - 100%</div>
            </div>
        </div>
    </div>

<script>
// ページのDOM要素がすべて読み込まれた後にスクリプトを実行
document.addEventListener('DOMContentLoaded', () => {

    /**
     * ベーシックなスライダーを初期化する関数
     * @param {string} id - スライダーコンテナのID
     */
    function initSlider(id) {
        const container = document.getElementById(id);
        if (!container) return; // 要素がなければ何もしない
        const thumb = container.querySelector('.slider-thumb');
        const fill = container.querySelector('.slider-fill');
        const valueDisplay = document.getElementById(`${id}-value`);
        
        let isDragging = false; // ドラッグ中かどうかを保持するフラグ
        
        // UIを更新する関数
        function applyUpdate(percent) {
            thumb.style.left = `${percent}%`;
            fill.style.width = `${percent}%`;
            if (valueDisplay) valueDisplay.textContent = `${Math.round(percent)}%`;
        }

        // ドラッグ開始時の処理
        function handleDragStart(e) {
            e.preventDefault(); // ブラウザのデフォルトのドラッグ動作（画像選択など）を防ぐ
            isDragging = true;
            thumb.classList.add('is-active'); // ドラッグ中のスタイルを適用するためのクラスを追加
            // document全体にイベントリスナーを追加。これにより、カーソルがスライダーの外に出てもドラッグを継続できる
            document.addEventListener('mousemove', handleDragMove);
            document.addEventListener('mouseup', handleDragEnd);
            document.addEventListener('touchmove', handleDragMove); // スマホ対応
            document.addEventListener('touchend', handleDragEnd);   // スマホ対応
        }

        // ドラッグ中の処理
        function handleDragMove(e) {
            if (!isDragging) return; // ドラッグ中でなければ何もしない
            const rect = container.getBoundingClientRect(); // スライダーコンテナの寸法と位置を取得
            // マウスかタッチかに応じて座標を取得
            const coord = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
            // コンテナの左端からの相対位置を計算（0以上、コンテナ幅以下に制限）
            const pos = Math.max(0, Math.min(coord - rect.left, rect.width));
            // 位置をパーセンテージに変換
            const percent = (pos / rect.width) * 100;
            applyUpdate(percent);
        }

        // ドラッグ終了時の処理
        function handleDragEnd() {
            if (!isDragging) return;
            isDragging = false;
            thumb.classList.remove('is-active'); // スタイル用クラスを削除
            // documentに追加したリスナーを削除。不要な処理を減らし、パフォーマンスを向上させる
            document.removeEventListener('mousemove', handleDragMove);
            document.removeEventListener('mouseup', handleDragEnd);
            document.removeEventListener('touchmove', handleDragMove);
            document.removeEventListener('touchend', handleDragEnd);
        }

        // ハンドル（thumb）にドラッグ開始イベントを設定
        thumb.addEventListener('mousedown', handleDragStart);
        thumb.addEventListener('touchstart', handleDragStart);
        
        applyUpdate(30); // 初期値を30%に設定
    }

    /**
     * レンジスライダーを初期化する関数
     * @param {string} id - スライダーコンテナのID
     */
    function initRangeSlider(id) {
        const container = document.getElementById(id);
        if (!container) return;
        const [thumbMin, thumbMax] = container.querySelectorAll('.slider-thumb');
        const fill = container.querySelector('.slider-fill');
        const valueDisplay = document.getElementById(`${id}-value`);
        
        let activeThumb = null; // 現在ドラッグ中のハンドルを保持

        // UI更新関数
        function applyUpdate() {
            // データ属性からパーセント値を取得（なければデフォルト値）
            const minPercent = parseFloat(thumbMin.dataset.percent || 0);
            const maxPercent = parseFloat(thumbMax.dataset.percent || 100);
            
            thumbMin.style.left = `${minPercent}%`;
            thumbMax.style.left = `${maxPercent}%`;
            fill.style.left = `${minPercent}%`; // fill要素の開始位置
            fill.style.width = `${maxPercent - minPercent}%`; // fill要素の幅
            
            valueDisplay.textContent = `${Math.round(minPercent)}% - ${Math.round(maxPercent)}%`;
        }

        function handleDragStart(e) {
            e.preventDefault();
            activeThumb = e.target; // クリックされたハンドルをアクティブに設定
            activeThumb.classList.add('is-active');
            document.addEventListener('mousemove', handleDragMove);
            document.addEventListener('mouseup', handleDragEnd);
            document.addEventListener('touchmove', handleDragMove);

            document.addEventListener('touchend', handleDragEnd);
        }
        
        function handleDragMove(e) {
            if (!activeThumb) return;
            const rect = container.getBoundingClientRect();
            const pos = Math.max(0, Math.min((e.type === 'touchmove' ? e.touches[0].clientX : e.clientX) - rect.left, rect.width));
            const percent = (pos / rect.width) * 100;
            
            const minPercent = parseFloat(thumbMin.dataset.percent || 0);
            const maxPercent = parseFloat(thumbMax.dataset.percent || 100);

            // ハンドルがもう片方を追い越さないように制限
            if (activeThumb === thumbMin && percent <= maxPercent) {
                thumbMin.dataset.percent = percent; // 位置をデータ属性に保存
            } else if (activeThumb === thumbMax && percent >= minPercent) {
                thumbMax.dataset.percent = percent;
            }
            applyUpdate();
        }

        function handleDragEnd() {
            if(activeThumb) activeThumb.classList.remove('is-active');
            activeThumb = null; // アクティブなハンドルをリセット
            document.removeEventListener('mousemove', handleDragMove);
            document.removeEventListener('mouseup', handleDragEnd);
            document.removeEventListener('touchmove', handleDragMove);
            document.removeEventListener('touchend', handleDragEnd);
        }
        
        // 2つのハンドルにイベントリスナーを設定
        [thumbMin, thumbMax].forEach(thumb => {
            thumb.addEventListener('mousedown', handleDragStart);
            thumb.addEventListener('touchstart', handleDragStart);
        });
        
        // 初期値を設定
        thumbMin.dataset.percent = 20;
        thumbMax.dataset.percent = 80;
        applyUpdate();
    }

    // --- 作成したすべてのスライダーを初期化 ---
    initSlider('slider-basic');
    initRangeSlider('slider-range');
    initSlider('slider-rich-basic');
    initRangeSlider('slider-rich-range');
});
</script>

</body>
</html>